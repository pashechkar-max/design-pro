{% extends 'main/base.html' %}

{% block title %}Change status | Design Pro{% endblock %}

{% block content %}
<section class="card form">
  <h1>Change of status</h1>
  <p>Application: <b>{{ request_obj.title }}</b></p>

  <form class="col" method="post" enctype="multipart/form-data">
    {% csrf_token %}

    <div class="field">
      <b>Current status:</b>
      {% if request_obj.status == 'new' %}
        <span class="st snew">{{ request_obj.get_status_display }}</span>
      {% elif request_obj.status == 'in_progress' %}
        <span class="st sprog">{{ request_obj.get_status_display }}</span>
      {% else %}
        <span class="st sdone">{{ request_obj.get_status_display }}</span>
      {% endif %}
    </div>

    <div class="row">
      <input type="hidden" name="status" value="{{ request_obj.status }}">
      {% if request_obj.status == 'new' %}
        <button class="btn b2" type="submit" name="status" value="in_progress">In progress</button>
      {% elif request_obj.status == 'in_progress' %}
        <button class="btn b2" type="submit" name="status" value="done">Done</button>
      {% else %}
        <p class="empty">The application is complete and the status cannot be changed.</p>
      {% endif %}
    </div>

    <label class="field">
      <span>{{ form.admin_comment.label }}</span>
      {{ form.admin_comment }}
      {% if form.admin_comment.errors %}
        <span class="err">{{ form.admin_comment.errors.0 }}</span>
      {% endif %}
    </label>

    <label class="field">
      <span>{{ form.result_image.label }}</span>
      {{ form.result_image }}
      {% if form.result_image.errors %}
        <span class="err">{{ form.result_image.errors.0 }}</span>
      {% endif %}
    </label>

    {% if form.non_field_errors %}
      <div class="msg e">
        {{ form.non_field_errors }}
      </div>
    {% endif %}

    <div class="row">
      {% if not is_done %}
        <button class="btn b1" type="submit">Save</button>
      {% endif %}
      <a class="btn b4" href="{% url 'filter_status' %}">Back</a>
    </div>
  </form>
</section>
{% endblock %}